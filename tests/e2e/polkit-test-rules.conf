/* Polkit rules for e2e testing
 *
 * Allows test actions for testuser with authentication
 */

polkit.addRule(function(action, subject) {
    // Test action that always requires authentication
    // IMPORTANT: We use AUTH_ADMIN to force authentication every time (no caching)
    if (action.id == "org.quickshell.polkit.test.auth-required") {
        // Force authentication for ALL users (including root)
        return polkit.Result.AUTH_ADMIN;
    }

    // Test action that should be denied
    if (action.id == "org.quickshell.polkit.test.deny") {
        return polkit.Result.NO;
    }

    // Test action that's allowed without authentication
    if (action.id == "org.quickshell.polkit.test.allow") {
        if (subject.user == "testuser") {
            return polkit.Result.YES;
        }
    }

    // Test run0-style action (systemd)
    if (action.id == "org.freedesktop.systemd1.manage-units") {
        if (subject.user == "testuser") {
            return polkit.Result.AUTH_ADMIN;
        }
    }
});
