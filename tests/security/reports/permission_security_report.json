{
  "test_type": "Permission Manipulation Security",
  "timestamp": "2025-10-23 09:21:57",
  "summary": {
    "total_tests": 8,
    "passed": 4,
    "failed": 1,
    "errors": 0,
    "detected_issues": 3,
    "success_rate": "50.0%"
  },
  "results": [
    {
      "test": "Socket directory world-writable check",
      "directory": "/tmp/quickshell_perm_test_ymoykjnw",
      "permissions": "777",
      "status": "FAIL",
      "description": "Directory should not be world-writable",
      "security_issue": "World-writable socket directory allows privilege escalation",
      "test_validates_detection": true
    },
    {
      "test": "Symlink to sensitive directory",
      "symlink_path": "/tmp/quickshell_symlink_test_q0rpsxmv/malicious_socket",
      "target": "/etc",
      "is_symlink": true,
      "status": "DETECTED",
      "description": "Agent should not follow symlinks to sensitive locations",
      "security_issue": "Symlink attack vector detected"
    },
    {
      "test": "Directory traversal symlink",
      "symlink_path": "/tmp/quickshell_symlink_test_q0rpsxmv/traversal",
      "target": "../../",
      "status": "DETECTED",
      "description": "Directory traversal attack via symlink"
    },
    {
      "test": "Socket file ownership and permissions",
      "file_path": "/tmp/quickshell_ownership_test_bz9isduy/test_socket",
      "permissions": "644",
      "owner_uid": 1000,
      "owner_gid": 1000,
      "current_uid": 1000,
      "status": "PASS"
    },
    {
      "test": "Umask security test (022)",
      "umask": "022",
      "file_permissions": "644",
      "expected_permissions": "644",
      "status": "PASS"
    },
    {
      "test": "Umask security test (027)",
      "umask": "027",
      "file_permissions": "640",
      "expected_permissions": "640",
      "status": "PASS"
    },
    {
      "test": "Umask security test (077)",
      "umask": "077",
      "file_permissions": "600",
      "expected_permissions": "600",
      "status": "PASS"
    },
    {
      "test": "Permission race condition",
      "permission_checks": [
        "600",
        "600",
        "666",
        "666",
        "666",
        "666",
        "666",
        "666",
        "666",
        "666"
      ],
      "unique_permissions": [
        "600",
        "666"
      ],
      "status": "DETECTED",
      "description": "Multiple permission states detected during race condition",
      "security_issue": "Race condition allows insecure permissions"
    }
  ]
}